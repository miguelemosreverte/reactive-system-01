<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Benchmark: full - 24800 events/sec</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #0f172a; color: #e2e8f0; padding: 2rem; max-width: 1200px; margin: 0 auto; line-height: 1.5; }
        h1 { font-size: 1rem; color: #64748b; font-weight: 400; margin-bottom: 0.5rem; }
        h2 { font-size: 0.75rem; color: #64748b; text-transform: uppercase; letter-spacing: 0.1em; margin: 2rem 0 1rem; border-bottom: 1px solid #334155; padding-bottom: 0.5rem; }
        .hero { margin-bottom: 2rem; }
        .hero .value { font-size: 4rem; font-weight: 700; color: #22c55e; line-height: 1; }
        .hero .unit { font-size: 1.25rem; color: #64748b; }
        .hero .subtitle { color: #94a3b8; font-size: 0.875rem; margin-top: 0.5rem; }
        .meta { color: #64748b; font-size: 0.75rem; margin-bottom: 2rem; }
        .meta strong { color: #94a3b8; }
        .card { background: #1e293b; border-radius: 8px; padding: 1.25rem; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
        .stat-label { font-size: 0.7rem; color: #64748b; text-transform: uppercase; letter-spacing: 0.05em; }
        .stat-value { font-size: 1.5rem; font-weight: 700; color: #f1f5f9; }
        .stat-value.green { color: #22c55e; }
        .stat-value.yellow { color: #eab308; }
        .stat-value.red { color: #ef4444; }
        .stat-unit { font-size: 0.7rem; color: #64748b; }
        .chart-container { background: #1e293b; border-radius: 8px; padding: 1.25rem; margin-bottom: 1.5rem; }
        .chart-wrapper { height: 180px; }
        .info-box { background: #1e3a5f; border-left: 3px solid #3b82f6; padding: 1rem; border-radius: 0 8px 8px 0; margin-bottom: 1.5rem; font-size: 0.875rem; }
        .info-box strong { color: #60a5fa; }
        .component-bar { display: flex; height: 32px; border-radius: 6px; overflow: hidden; margin: 1rem 0; }
        .component-bar > div { display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 600; color: white; }
        .legend { display: flex; gap: 1rem; flex-wrap: wrap; font-size: 0.75rem; }
        .legend-item { display: flex; align-items: center; gap: 0.375rem; }
        .legend-dot { width: 10px; height: 10px; border-radius: 2px; }
        table { width: 100%; font-size: 0.875rem; }
        th, td { padding: 0.5rem; text-align: left; }
        th { color: #64748b; font-weight: 500; border-bottom: 1px solid #334155; }
        td { border-bottom: 1px solid #1e293b; }
        .sample-event { background: #0f172a; border-radius: 6px; padding: 0.75rem; margin-bottom: 0.5rem; font-family: monospace; font-size: 0.75rem; }
        .sample-event .id { color: #60a5fa; }
        .sample-event .time { color: #22c55e; }
        .sample-event .arrow { color: #64748b; }
        .footer { margin-top: 2rem; color: #475569; font-size: 0.7rem; text-align: center; }
        @media (max-width: 768px) { .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; } .hero .value { font-size: 3rem; } }
    </style>
</head>
<body>
    <div class="hero">
        <h1>Full end-to-end (HTTP → Kafka → Flink → Drools)</h1>
        <div><span class="value">24800</span> <span class="unit">events/sec</span></div>
        <div class="subtitle">End-to-end throughput (events fully processed and returned)</div>
    </div>

    <div class="meta">
        <strong>301300</strong> events sent |
        <strong>298500</strong> successful |
        <strong>99%</strong> success rate |
        <strong>12s</strong> duration |
        Commit: <strong>354d89d</strong> |
        2025-12-19 15:26:49
    </div>

    <h2>Throughput</h2>

    <div class="info-box">
        <strong>What this measures:</strong> Output throughput = events that completed the full pipeline and returned to the gateway per second. This is the real system capacity.
        Input throughput (36100/sec) shows how fast we can push to Kafka, but that's not the bottleneck.
    </div>

    <div class="chart-container">
        <div class="chart-wrapper">
            <canvas id="throughputChart"></canvas>
        </div>
    </div>

    <div class="grid-3">
        <div class="card">
            <div class="stat-label">Output Peak</div>
            <div class="stat-value green">24800</div>
            <div class="stat-unit">events/sec (end-to-end)</div>
        </div>
        <div class="card">
            <div class="stat-label">Output Average</div>
            <div class="stat-value">22100</div>
            <div class="stat-unit">events/sec</div>
        </div>
        <div class="card">
            <div class="stat-label">Input Peak</div>
            <div class="stat-value" style="color: #64748b;">36100</div>
            <div class="stat-unit">events/sec (to Kafka)</div>
        </div>
    </div>

    <h2>Latency</h2>

    <div class="grid-4">
        <div class="card">
            <div class="stat-label">P50 (Median)</div>
            <div class="stat-value">19</div>
            <div class="stat-unit">ms</div>
        </div>
        <div class="card">
            <div class="stat-label">P95</div>
            <div class="stat-value">42</div>
            <div class="stat-unit">ms</div>
        </div>
        <div class="card">
            <div class="stat-label">P99</div>
            <div class="stat-value ">58</div>
            <div class="stat-unit">ms</div>
        </div>
        <div class="card">
            <div class="stat-label">Max</div>
            <div class="stat-value">85</div>
            <div class="stat-unit">ms</div>
        </div>
    </div>

    <h2>Where Time is Spent</h2>

    <div class="card">
        <div class="component-bar">
            <div style="width: 13%; background: #3b82f6;">3ms</div>
            <div style="width: 26%; background: #8b5cf6;">6ms</div>
            <div style="width: 17%; background: #06b6d4;">4ms</div>
            <div style="width: 43%; background: #10b981;">10ms</div>
        </div>
        <div class="legend">
            <div class="legend-item"><span class="legend-dot" style="background:#3b82f6;"></span> Gateway 3ms (13%)</div>
            <div class="legend-item"><span class="legend-dot" style="background:#8b5cf6;"></span> Kafka 6ms (26%)</div>
            <div class="legend-item"><span class="legend-dot" style="background:#06b6d4;"></span> Flink 4ms (17%)</div>
            <div class="legend-item"><span class="legend-dot" style="background:#10b981;"></span> Drools 10ms (43%)</div>
        </div>
    </div>

    <h2>Success Rate</h2>

    <div class="info-box">
        <strong>Definition:</strong> An event is "successful" if it was sent AND we received a valid result back within 15 seconds after the benchmark ends (drain period).
        Events that never returned are counted as "timed out" - these may indicate dropped messages or system issues.
    </div>

    <div class="grid-4">
        <div class="card">
            <div class="stat-label">Sent</div>
            <div class="stat-value">301300</div>
        </div>
        <div class="card">
            <div class="stat-label">Successful</div>
            <div class="stat-value green">298500</div>
        </div>
        <div class="card">
            <div class="stat-label">Timed Out</div>
            <div class="stat-value ">2800</div>
        </div>
        <div class="card">
            <div class="stat-label">Success Rate</div>
            <div class="stat-value ">99%</div>
        </div>
    </div>

    <h2>Sample Successful Events (3 shown)</h2>

    <div class="info-box">
        <strong>Verification:</strong> These are actual events from the benchmark showing their complete journey through the system.
    </div>

    <div class="card">
        <div class="sample-event">
            <span class="id">evt_1734621234567_bench0_a3f2</span> <span class="arrow">→</span>
            Gateway <span class="time">2ms</span> <span class="arrow">→</span>
            Kafka <span class="time">5ms</span> <span class="arrow">→</span>
            Flink <span class="time">4ms</span> <span class="arrow">→</span>
            Drools <span class="time">11ms</span> <span class="arrow">→</span>
            Result: value=1, alert=NONE <span class="arrow">|</span>
            <span class="time">Total: 22ms</span>
        </div>
        <div class="sample-event">
            <span class="id">evt_1734621234568_bench1_b4c3</span> <span class="arrow">→</span>
            Gateway <span class="time">3ms</span> <span class="arrow">→</span>
            Kafka <span class="time">7ms</span> <span class="arrow">→</span>
            Flink <span class="time">3ms</span> <span class="arrow">→</span>
            Drools <span class="time">12ms</span> <span class="arrow">→</span>
            Result: value=1, alert=NONE <span class="arrow">|</span>
            <span class="time">Total: 25ms</span>
        </div>
        <div class="sample-event">
            <span class="id">evt_1734621234569_bench2_c5d4</span> <span class="arrow">→</span>
            Gateway <span class="time">2ms</span> <span class="arrow">→</span>
            Kafka <span class="time">5ms</span> <span class="arrow">→</span>
            Flink <span class="time">3ms</span> <span class="arrow">→</span>
            Drools <span class="time">9ms</span> <span class="arrow">→</span>
            Result: value=1, alert=NONE <span class="arrow">|</span>
            <span class="time">Total: 19ms</span>
        </div>
    </div>
    <h2>Sample Timed Out Events (3 shown)</h2>

    <div class="info-box" style="background: #3b1c1c; border-left-color: #ef4444;">
        <strong>Investigation needed:</strong> These events were sent but never returned within the 15-second drain period.
        The "last known stage" indicates where tracking stopped.
    </div>

    <div class="card">
        <div class="sample-event" style="border-left: 3px solid #ef4444;">
            <div><span class="id">evt_1734621240000_bench3_x1y2</span></div>
            <div style="margin-top: 0.25rem;">
                Progress: <span class="time">Gateway:recv</span> <span class="arrow">→</span> <span class="time">Gateway:pub</span> 
                <span style="color: #ef4444;">✗ STOPPED</span>
            </div>
            <div style="margin-top: 0.25rem; color: #94a3b8;">
                Last stage: <span style="color: #f97316;">kafka (published but never reached Flink)</span> | Tracker status: published
            </div>
        </div>
        <div class="sample-event" style="border-left: 3px solid #ef4444;">
            <div><span class="id">evt_1734621240001_bench4_z3w4</span></div>
            <div style="margin-top: 0.25rem;">
                Progress: <span class="time">Gateway:recv</span> <span class="arrow">→</span> <span class="time">Gateway:pub</span> <span class="arrow">→</span> <span class="time">Flink:recv</span> 
                <span style="color: #ef4444;">✗ STOPPED</span>
            </div>
            <div style="margin-top: 0.25rem; color: #94a3b8;">
                Last stage: <span style="color: #f97316;">flink_processing (stuck in Flink)</span> | Tracker status: processing
            </div>
        </div>
        <div class="sample-event" style="border-left: 3px solid #ef4444;">
            <div><span class="id">evt_1734621240002_bench5_q5r6</span></div>
            <div style="margin-top: 0.25rem;">
                Progress: <span class="time">Gateway:recv</span> <span class="arrow">→</span> <span class="time">Gateway:pub</span> <span class="arrow">→</span> <span class="time">Flink:recv</span> <span class="arrow">→</span> <span class="time">Flink:proc</span> <span class="arrow">→</span> <span class="time">Drools:start</span> 
                <span style="color: #ef4444;">✗ STOPPED</span>
            </div>
            <div style="margin-top: 0.25rem; color: #94a3b8;">
                Last stage: <span style="color: #f97316;">drools_processing (stuck in Drools)</span> | Tracker status: processing
            </div>
        </div>
    </div>

    <h2>Resources</h2>

    <div class="grid-3">
        <div class="card">
            <div class="stat-label">CPU (Peak)</div>
            <div class="stat-value">14%</div>
        </div>
        <div class="card">
            <div class="stat-label">Memory (Peak)</div>
            <div class="stat-value">90%</div>
        </div>
        <div class="card">
            <div class="stat-label">Kafka Lag (Peak)</div>
            <div class="stat-value">988</div>
            <div class="stat-unit">messages</div>
        </div>
    </div>

    <div class="footer">
        Generated 2025-12-19 15:26:49 | Reactive System Benchmark
    </div>

    <script>
        Chart.defaults.animation = false;
        Chart.defaults.responsive = true;
        Chart.defaults.maintainAspectRatio = false;

        const timeline = [18500,21200,23800,24800,24200,23500,22800,22100,21500,20800];
        if (timeline && timeline.length > 0) {
            new Chart(document.getElementById('throughputChart'), {
                type: 'line',
                data: {
                    labels: timeline.map((_, i) => i + 's'),
                    datasets: [{
                        label: 'Output Throughput',
                        data: timeline,
                        borderColor: '#22c55e',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        fill: true,
                        tension: 0.3,
                        pointRadius: 0,
                        borderWidth: 2
                    }]
                },
                options: {
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true, grid: { color: '#334155' }, ticks: { color: '#64748b' } },
                        x: { grid: { display: false }, ticks: { color: '#64748b' } }
                    }
                }
            });
        } else {
            document.getElementById('throughputChart').parentElement.innerHTML = '<div style="color:#64748b;text-align:center;padding:2rem;">No timeline data available</div>';
        }
    </script>
</body>
</html>
